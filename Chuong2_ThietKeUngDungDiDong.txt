================================================================================
CHÆ¯Æ NG 2: PHÃ‚N TÃCH VÃ€ THIáº¾T Káº¾ Há»† THá»NG
Pháº§n 2.5: THIáº¾T Káº¾ á»¨NG Dá»¤NG DI Äá»˜NG
Pháº§n thá»±c hiá»‡n: NgÃ´ Viá»‡t Anh
================================================================================

2.5.1. YÃŠU Cáº¦U CHá»¨C NÄ‚NG á»¨NG Dá»¤NG MOBILE

á»¨ng dá»¥ng di Ä‘á»™ng lÃ  giao diá»‡n chÃ­nh Ä‘á»ƒ ngÆ°á»i dÃ¹ng tÆ°Æ¡ng tÃ¡c vá»›i há»‡ thá»‘ng Ä‘á»•i 
pin. CÃ¡c yÃªu cáº§u chá»©c nÄƒng bao gá»“m:

1. Authentication:
   - ÄÄƒng kÃ½ tÃ i khoáº£n má»›i
   - ÄÄƒng nháº­p báº±ng username/password
   - Äáº·t láº¡i máº­t kháº©u qua sá»‘ Ä‘iá»‡n thoáº¡i
   - LÆ°u phiÃªn Ä‘Äƒng nháº­p (persistent session)

2. Map & Location:
   - Hiá»ƒn thá»‹ báº£n Ä‘á»“ vá»›i cÃ¡c tráº¡m Ä‘á»•i pin
   - Äá»‹nh vá»‹ vá»‹ trÃ­ hiá»‡n táº¡i cá»§a ngÆ°á»i dÃ¹ng
   - TÃ­nh khoáº£ng cÃ¡ch tá»« vá»‹ trÃ­ hiá»‡n táº¡i Ä‘áº¿n cÃ¡c tráº¡m
   - Filter tráº¡m theo tráº¡ng thÃ¡i (active, cÃ³ pin kháº£ dá»¥ng)

3. QR Scanner:
   - QuÃ©t mÃ£ QR táº¡i tráº¡m Ä‘á»ƒ báº¯t Ä‘áº§u Ä‘á»•i pin
   - XÃ¡c thá»±c mÃ£ QR vá»›i backend
   - Hiá»ƒn thá»‹ thÃ´ng tin giao dá»‹ch

4. Wallet & Payment:
   - Hiá»ƒn thá»‹ sá»‘ dÆ° vÃ­
   - Náº¡p tiá»n qua MoMo
   - Xem lá»‹ch sá»­ giao dá»‹ch
   - Xem chi tiáº¿t tá»«ng giao dá»‹ch

5. Profile Management:
   - Xem thÃ´ng tin cÃ¡ nhÃ¢n
   - Chá»‰nh sá»­a thÃ´ng tin (tÃªn, email, avatar)
   - Xem pin Ä‘ang sá»­ dá»¥ng
   - Äá»•i máº­t kháº©u
   - ÄÄƒng xuáº¥t

6. Multi-language:
   - Tiáº¿ng Viá»‡t
   - Tiáº¿ng Anh

7. Theme:
   - Light mode
   - Dark mode


2.5.2. KIáº¾N TRÃšC á»¨NG Dá»¤NG

2.5.2.1. Component-based Architecture

á»¨ng dá»¥ng Ä‘Æ°á»£c tá»• chá»©c theo kiáº¿n trÃºc component-based cá»§a React Native:

```
ev-swap/
â”œâ”€â”€ App.tsx                      # Root component, navigation setup
â”œâ”€â”€ screens/                     # CÃ¡c mÃ n hÃ¬nh chÃ­nh
â”‚   â”œâ”€â”€ LoginScreen.tsx          # ÄÄƒng nháº­p
â”‚   â”œâ”€â”€ SignUpScreen.tsx         # ÄÄƒng kÃ½
â”‚   â”œâ”€â”€ HomeScreen.tsx           # MÃ n hÃ¬nh chÃ­nh
â”‚   â”œâ”€â”€ MapScreen.tsx            # Báº£n Ä‘á»“ tráº¡m
â”‚   â”œâ”€â”€ QRScannerScreen.tsx      # QuÃ©t QR
â”‚   â”œâ”€â”€ StationDetailsScreen.tsx # Chi tiáº¿t tráº¡m
â”‚   â”œâ”€â”€ WalletScreen.tsx         # VÃ­ tiá»n
â”‚   â”œâ”€â”€ HistoryScreen.tsx        # Lá»‹ch sá»­ giao dá»‹ch
â”‚   â”œâ”€â”€ AccountScreen.tsx        # TÃ i khoáº£n
â”‚   â”œâ”€â”€ PersonalInfoScreen.tsx   # ThÃ´ng tin cÃ¡ nhÃ¢n
â”‚   â”œâ”€â”€ SettingsScreen.tsx       # CÃ i Ä‘áº·t
â”‚   â””â”€â”€ HelpScreen.tsx           # Há»— trá»£
â”œâ”€â”€ components/                  # Reusable components
â”‚   â”œâ”€â”€ MainLayout.tsx           # Layout chung
â”‚   â”œâ”€â”€ Header.tsx               # Header component
â”‚   â”œâ”€â”€ Modal.tsx                # Modal component
â”‚   â”œâ”€â”€ Accordion.tsx            # Accordion component
â”‚   â”œâ”€â”€ ToggleSwitch.tsx         # Toggle switch
â”‚   â””â”€â”€ icons.tsx                # Icon components
â”œâ”€â”€ contexts.tsx                 # Context API (Auth, Theme, I18n)
â”œâ”€â”€ services/                    # API services (náº¿u tÃ¡ch riÃªng)
â”‚   â””â”€â”€ api.ts                   # Axios instance, API calls
â”œâ”€â”€ hooks/                       # Custom hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useTheme.ts
â”‚   â””â”€â”€ useI18n.ts
â”œâ”€â”€ types.ts                     # TypeScript types
â”œâ”€â”€ constants.ts                 # App constants
â”œâ”€â”€ theme.ts                     # Theme configuration
â”œâ”€â”€ locales/                     # Translation files
â”‚   â”œâ”€â”€ en.json                  # Tiáº¿ng Anh
â”‚   â””â”€â”€ vi.json                  # Tiáº¿ng Viá»‡t
â””â”€â”€ assets/                      # Images, fonts
```

2.5.2.2. Navigation Structure

Sá»­ dá»¥ng React Navigation vá»›i Stack Navigator vÃ  Bottom Tab Navigator:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Stack Navigator (Root)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Auth Stack (Not logged in)                â”‚   â”‚
â”‚  â”‚   - LoginScreen                             â”‚   â”‚
â”‚  â”‚   - SignUpScreen                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Main Stack (Logged in)                    â”‚   â”‚
â”‚  â”‚                                             â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚   â”‚  Bottom Tab Navigator             â”‚     â”‚   â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”        â”‚     â”‚   â”‚
â”‚  â”‚   â”‚  â”‚Home â”‚ Map â”‚Walletâ”‚Acct â”‚        â”‚     â”‚   â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜        â”‚     â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                             â”‚   â”‚
â”‚  â”‚   Modal/Overlay screens:                    â”‚   â”‚
â”‚  â”‚   - QRScannerScreen                         â”‚   â”‚
â”‚  â”‚   - StationDetailsScreen                    â”‚   â”‚
â”‚  â”‚   - PersonalInfoScreen                      â”‚   â”‚
â”‚  â”‚   - SettingsScreen                          â”‚   â”‚
â”‚  â”‚   - HelpScreen                              â”‚   â”‚
â”‚  â”‚   - HistoryScreen                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

App.tsx implementation:
```typescript
import React, { useEffect, useState } from 'react';
import { NavigationContainer } from '@react-navigation/native';
import { createNativeStackNavigator } from '@react-navigation/native-stack';
import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';
import AsyncStorage from '@react-native-async-storage/async-storage';

// Contexts
import { AuthProvider, useAuth } from './contexts';

// Screens
import LoginScreen from './screens/LoginScreen';
import SignUpScreen from './screens/SignUpScreen';
import HomeScreen from './screens/HomeScreen';
import MapScreen from './screens/MapScreen';
import WalletScreen from './screens/WalletScreen';
import AccountScreen from './screens/AccountScreen';
import QRScannerScreen from './screens/QRScannerScreen';
import StationDetailsScreen from './screens/StationDetailsScreen';
import HistoryScreen from './screens/HistoryScreen';
import PersonalInfoScreen from './screens/PersonalInfoScreen';
import SettingsScreen from './screens/SettingsScreen';

const Stack = createNativeStackNavigator();
const Tab = createBottomTabNavigator();

// Bottom Tab Navigator
function MainTabs() {
  return (
    <Tab.Navigator>
      <Tab.Screen 
        name="Home" 
        component={HomeScreen}
        options={{ title: 'Trang chá»§' }}
      />
      <Tab.Screen 
        name="Map" 
        component={MapScreen}
        options={{ title: 'Báº£n Ä‘á»“' }}
      />
      <Tab.Screen 
        name="Wallet" 
        component={WalletScreen}
        options={{ title: 'VÃ­ tiá»n' }}
      />
      <Tab.Screen 
        name="Account" 
        component={AccountScreen}
        options={{ title: 'TÃ i khoáº£n' }}
      />
    </Tab.Navigator>
  );
}

// Auth Stack
function AuthStack() {
  return (
    <Stack.Navigator screenOptions={{ headerShown: false }}>
      <Stack.Screen name="Login" component={LoginScreen} />
      <Stack.Screen name="SignUp" component={SignUpScreen} />
    </Stack.Navigator>
  );
}

// Main Stack (after login)
function MainStack() {
  return (
    <Stack.Navigator>
      <Stack.Screen 
        name="MainTabs" 
        component={MainTabs}
        options={{ headerShown: false }}
      />
      <Stack.Screen 
        name="QRScanner" 
        component={QRScannerScreen}
        options={{ presentation: 'modal', title: 'QuÃ©t QR' }}
      />
      <Stack.Screen 
        name="StationDetails" 
        component={StationDetailsScreen}
        options={{ title: 'Chi tiáº¿t tráº¡m' }}
      />
      <Stack.Screen 
        name="History" 
        component={HistoryScreen}
        options={{ title: 'Lá»‹ch sá»­' }}
      />
      <Stack.Screen 
        name="PersonalInfo" 
        component={PersonalInfoScreen}
        options={{ title: 'ThÃ´ng tin cÃ¡ nhÃ¢n' }}
      />
      <Stack.Screen 
        name="Settings" 
        component={SettingsScreen}
        options={{ title: 'CÃ i Ä‘áº·t' }}
      />
    </Stack.Navigator>
  );
}

// Root Navigator
function RootNavigator() {
  const { user, loading } = useAuth();

  if (loading) {
    return <LoadingScreen />;
  }

  return user ? <MainStack /> : <AuthStack />;
}

// App Component
export default function App() {
  return (
    <AuthProvider>
      <NavigationContainer>
        <RootNavigator />
      </NavigationContainer>
    </AuthProvider>
  );
}
```

2.5.2.3. State Management vá»›i Context API

File: contexts.tsx

```typescript
import React, { createContext, useContext, useState, useEffect } from 'react';
import AsyncStorage from '@react-native-async-storage/async-storage';

// Auth Context
interface User {
  id: number;
  username: string;
  fullName: string;
  balance: number;
  currentBatteryUid?: string;
}

interface AuthContextType {
  user: User | null;
  token: string | null;
  loading: boolean;
  login: (username: string, password: string) => Promise<void>;
  logout: () => Promise<void>;
  updateUser: (user: User) => void;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [token, setToken] = useState<string | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Load saved auth data on app start
    loadAuthData();
  }, []);

  const loadAuthData = async () => {
    try {
      const savedToken = await AsyncStorage.getItem('token');
      const savedUser = await AsyncStorage.getItem('user');
      
      if (savedToken && savedUser) {
        setToken(savedToken);
        setUser(JSON.parse(savedUser));
      }
    } catch (error) {
      console.error('Load auth data error:', error);
    } finally {
      setLoading(false);
    }
  };

  const login = async (username: string, password: string) => {
    try {
      const response = await fetch('https://your-backend.herokuapp.com/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, password })
      });

      const data = await response.json();

      if (data.success) {
        setToken(data.token);
        setUser(data.customer);
        
        // Save to AsyncStorage
        await AsyncStorage.setItem('token', data.token);
        await AsyncStorage.setItem('user', JSON.stringify(data.customer));
      } else {
        throw new Error(data.message);
      }
    } catch (error) {
      throw error;
    }
  };

  const logout = async () => {
    setUser(null);
    setToken(null);
    await AsyncStorage.removeItem('token');
    await AsyncStorage.removeItem('user');
  };

  const updateUser = (updatedUser: User) => {
    setUser(updatedUser);
    AsyncStorage.setItem('user', JSON.stringify(updatedUser));
  };

  return (
    <AuthContext.Provider value={{ user, token, loading, login, logout, updateUser }}>
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within AuthProvider');
  }
  return context;
}

// Theme Context
interface ThemeContextType {
  isDarkMode: boolean;
  toggleTheme: () => void;
  colors: {
    primary: string;
    background: string;
    text: string;
    card: string;
  };
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: React.ReactNode }) {
  const [isDarkMode, setIsDarkMode] = useState(false);

  const colors = isDarkMode
    ? {
        primary: '#4CAF50',
        background: '#121212',
        text: '#FFFFFF',
        card: '#1E1E1E'
      }
    : {
        primary: '#4CAF50',
        background: '#F5F5F5',
        text: '#000000',
        card: '#FFFFFF'
      };

  const toggleTheme = () => {
    setIsDarkMode(!isDarkMode);
  };

  return (
    <ThemeContext.Provider value={{ isDarkMode, toggleTheme, colors }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within ThemeProvider');
  }
  return context;
}

// I18n Context
interface I18nContextType {
  language: 'vi' | 'en';
  setLanguage: (lang: 'vi' | 'en') => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextType | undefined>(undefined);

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguage] = useState<'vi' | 'en'>('vi');

  const translations = {
    vi: require('./locales/vi.json'),
    en: require('./locales/en.json')
  };

  const t = (key: string): string => {
    return translations[language][key] || key;
  };

  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error('useI18n must be used within I18nProvider');
  }
  return context;
}
```

2.5.3. USER FLOW VÃ€ WIREFRAMES

2.5.3.1. Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Login Screen   â”‚
â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Username  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Password  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚
â”‚  [ ÄÄƒng nháº­p ]  â”‚
â”‚                 â”‚
â”‚  ChÆ°a cÃ³ TK?    â”‚
â”‚  ÄÄƒng kÃ½ ngay   â”‚
â”‚                 â”‚
â”‚  QuÃªn máº­t kháº©u? â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
  POST /api/auth/login
        â”‚
        â–¼
   Save token to
   AsyncStorage
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Home Screen    â”‚
â”‚  (Main Tabs)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

2.5.3.2. Swap Battery Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Home Screen    â”‚
â”‚                 â”‚
â”‚  [Äá»•i pin ngay] â”‚ â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Map Screen     â”‚
                 â”‚  Select Station â”‚
                 â”‚                 â”‚
                 â”‚  [ Xem chi tiáº¿t]â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Station Details â”‚
                 â”‚                 â”‚
                 â”‚ Available: 4/6  â”‚
                 â”‚                 â”‚
                 â”‚  [QuÃ©t QR code] â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  QR Scanner     â”‚
                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                 â”‚  â”‚ [Camera]  â”‚  â”‚
                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
               POST /api/transactions/start-swap
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Confirmation   â”‚
                 â”‚                 â”‚
                 â”‚ Láº¥y pin táº¡i     â”‚
                 â”‚ Slot 1          â”‚
                 â”‚                 â”‚
                 â”‚ [XÃ¡c nháº­n]      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
               PUT /api/transactions/:id/complete
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Success        â”‚
                 â”‚                 â”‚
                 â”‚ Äá»•i pin         â”‚
                 â”‚ thÃ nh cÃ´ng!     â”‚
                 â”‚                 â”‚
                 â”‚ Sá»‘ dÆ°: 43,000Ä‘  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

2.5.4. CHI TIáº¾T CÃC SCREENS

2.5.4.1. HomeScreen - MÃ n hÃ¬nh chÃ­nh

Wireframe:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜°  EV-Swap            ğŸ””  ğŸ‘¤         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Pin hiá»‡n táº¡i: UID-001        â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚   â”‚   ğŸ”‹                 â”‚     â”‚  â”‚
â”‚  â”‚   â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘         â”‚     â”‚  â”‚
â”‚  â”‚   â”‚   80%                â”‚     â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚   Chu ká»³ sáº¡c: 150 láº§n          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       [Äá»•i pin ngay]           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Sá»‘ dÆ° vÃ­: 43,000Ä‘            â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚   [Náº¡p tiá»n]                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  Lá»‹ch sá»­ giao dá»‹ch gáº§n Ä‘Ã¢y:         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 13/12/2024 08:35               â”‚  â”‚
â”‚  â”‚ Tráº¡m BÃ¡ch Khoa                 â”‚  â”‚
â”‚  â”‚ -7,000Ä‘                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 12/12/2024 14:20               â”‚  â”‚
â”‚  â”‚ Tráº¡m PTIT                      â”‚  â”‚
â”‚  â”‚ -7,000Ä‘                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  [Xem táº¥t cáº£]                        â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  ğŸ     ğŸ—ºï¸    ğŸ’°    ğŸ‘¤              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Implementation snippet (HomeScreen.tsx):
```typescript
import React, { useEffect, useState } from 'react';
import { View, Text, StyleSheet, TouchableOpacity, FlatList } from 'react-native';
import { useAuth } from '../contexts';

interface Transaction {
  id: number;
  stationName: string;
  cost: number;
  transactionTime: string;
}

export default function HomeScreen({ navigation }: any) {
  const { user, token } = useAuth();
  const [recentTransactions, setRecentTransactions] = useState<Transaction[]>([]);
  const [batteryLevel, setBatteryLevel] = useState(80); // Mock data

  useEffect(() => {
    fetchRecentTransactions();
  }, []);

  const fetchRecentTransactions = async () => {
    try {
      const response = await fetch('https://your-backend.herokuapp.com/api/me/history?limit=5', {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      const data = await response.json();
      if (data.success) {
        setRecentTransactions(data.transactions);
      }
    } catch (error) {
      console.error('Fetch transactions error:', error);
    }
  };

  return (
    <View style={styles.container}>
      {/* Battery Indicator */}
      <View style={styles.batteryCard}>
        <Text style={styles.batteryTitle}>Pin hiá»‡n táº¡i: {user?.currentBatteryUid}</Text>
        <BatteryIndicator level={batteryLevel} />
        <Text style={styles.batteryInfo}>Chu ká»³ sáº¡c: 150 láº§n</Text>
      </View>

      {/* Swap Button */}
      <TouchableOpacity 
        style={styles.swapButton}
        onPress={() => navigation.navigate('Map')}
      >
        <Text style={styles.swapButtonText}>Äá»•i pin ngay</Text>
      </TouchableOpacity>

      {/* Wallet Card */}
      <View style={styles.walletCard}>
        <Text style={styles.walletBalance}>Sá»‘ dÆ° vÃ­: {user?.balance.toLocaleString()}Ä‘</Text>
        <TouchableOpacity 
          style={styles.rechargeButton}
          onPress={() => navigation.navigate('Wallet')}
        >
          <Text style={styles.rechargeButtonText}>Náº¡p tiá»n</Text>
        </TouchableOpacity>
      </View>

      {/* Recent Transactions */}
      <Text style={styles.sectionTitle}>Lá»‹ch sá»­ giao dá»‹ch gáº§n Ä‘Ã¢y:</Text>
      <FlatList
        data={recentTransactions}
        keyExtractor={(item) => item.id.toString()}
        renderItem={({ item }) => (
          <View style={styles.transactionItem}>
            <Text style={styles.transactionDate}>
              {new Date(item.transactionTime).toLocaleDateString('vi-VN')}
            </Text>
            <Text style={styles.transactionStation}>{item.stationName}</Text>
            <Text style={styles.transactionCost}>-{item.cost.toLocaleString()}Ä‘</Text>
          </View>
        )}
      />

      <TouchableOpacity onPress={() => navigation.navigate('History')}>
        <Text style={styles.viewAllText}>Xem táº¥t cáº£</Text>
      </TouchableOpacity>
    </View>
  );
}

function BatteryIndicator({ level }: { level: number }) {
  return (
    <View style={styles.batteryIndicator}>
      <View style={[styles.batteryFill, { width: `${level}%` }]} />
      <Text style={styles.batteryPercentage}>{level}%</Text>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 16,
    backgroundColor: '#F5F5F5'
  },
  batteryCard: {
    backgroundColor: '#FFF',
    padding: 16,
    borderRadius: 8,
    marginBottom: 16
  },
  batteryIndicator: {
    height: 60,
    backgroundColor: '#E0E0E0',
    borderRadius: 8,
    overflow: 'hidden',
    justifyContent: 'center',
    alignItems: 'center',
    marginVertical: 12
  },
  batteryFill: {
    position: 'absolute',
    left: 0,
    top: 0,
    height: '100%',
    backgroundColor: '#4CAF50'
  },
  swapButton: {
    backgroundColor: '#4CAF50',
    padding: 16,
    borderRadius: 8,
    alignItems: 'center',
    marginBottom: 16
  },
  swapButtonText: {
    color: '#FFF',
    fontSize: 18,
    fontWeight: 'bold'
  }
  // ... more styles
});
```

2.5.4.2. MapScreen - Báº£n Ä‘á»“ tráº¡m

Wireframe:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â†  Báº£n Ä‘á»“ tráº¡m              ğŸ”       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚         ğŸ“                     â”‚  â”‚
â”‚  â”‚       ğŸ“   ğŸ“                  â”‚  â”‚
â”‚  â”‚            ğŸ”µ (You are here)   â”‚  â”‚
â”‚  â”‚    ğŸ“                          â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â”‚  Google Maps with markers      â”‚  â”‚
â”‚  â”‚                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tráº¡m BÃ¡ch Khoa          1.2km â”‚  â”‚
â”‚  â”‚ Available: 4/6                 â”‚  â”‚
â”‚  â”‚                  [Chi tiáº¿t]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tráº¡m PTIT               2.5km â”‚  â”‚
â”‚  â”‚ Available: 5/6                 â”‚  â”‚
â”‚  â”‚                  [Chi tiáº¿t]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Implementation (MapScreen.tsx):
```typescript
import React, { useEffect, useState } from 'react';
import { View, StyleSheet, FlatList, TouchableOpacity, Text } from 'react-native';
import MapView, { Marker, PROVIDER_GOOGLE } from 'react-native-maps';
import * as Location from 'expo-location';
import { useAuth } from '../contexts';

interface Station {
  id: number;
  name: string;
  location: string;
  availableSlots: number;
  totalSlots: number;
  status: string;
}

export default function MapScreen({ navigation }: any) {
  const { token } = useAuth();
  const [stations, setStations] = useState<Station[]>([]);
  const [userLocation, setUserLocation] = useState<any>(null);
  const [region, setRegion] = useState({
    latitude: 21.0063,
    longitude: 105.8433,
    latitudeDelta: 0.05,
    longitudeDelta: 0.05
  });

  useEffect(() => {
    getUserLocation();
    fetchStations();
  }, []);

  const getUserLocation = async () => {
    try {
      let { status } = await Location.requestForegroundPermissionsAsync();
      if (status !== 'granted') {
        alert('Quyá»n truy cáº­p vá»‹ trÃ­ bá»‹ tá»« chá»‘i');
        return;
      }

      let location = await Location.getCurrentPositionAsync({});
      setUserLocation({
        latitude: location.coords.latitude,
        longitude: location.coords.longitude
      });
      
      setRegion({
        latitude: location.coords.latitude,
        longitude: location.coords.longitude,
        latitudeDelta: 0.05,
        longitudeDelta: 0.05
      });
    } catch (error) {
      console.error('Get location error:', error);
    }
  };

  const fetchStations = async () => {
    try {
      const response = await fetch('https://your-backend.herokuapp.com/api/stations?status=active', {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      const data = await response.json();
      if (data.success) {
        setStations(data.stations);
      }
    } catch (error) {
      console.error('Fetch stations error:', error);
    }
  };

  const parseLocation = (locationString: string) => {
    const [address, lat, lng] = locationString.split(';');
    return {
      address,
      latitude: parseFloat(lat),
      longitude: parseFloat(lng)
    };
  };

  const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {
    const R = 6371; // Radius of Earth in km
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a = 
      Math.sin(dLat/2) * Math.sin(dLat/2) +
      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
      Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    const distance = R * c;
    return distance.toFixed(1);
  };

  return (
    <View style={styles.container}>
      <MapView
        provider={PROVIDER_GOOGLE}
        style={styles.map}
        region={region}
        showsUserLocation={true}
      >
        {stations.map(station => {
          const loc = parseLocation(station.location);
          return (
            <Marker
              key={station.id}
              coordinate={{
                latitude: loc.latitude,
                longitude: loc.longitude
              }}
              title={station.name}
              description={`Available: ${station.availableSlots}/${station.totalSlots}`}
            />
          );
        })}
      </MapView>

      <View style={styles.stationList}>
        <FlatList
          data={stations}
          keyExtractor={(item) => item.id.toString()}
          renderItem={({ item }) => {
            const loc = parseLocation(item.location);
            const distance = userLocation 
              ? calculateDistance(userLocation.latitude, userLocation.longitude, loc.latitude, loc.longitude)
              : 'N/A';

            return (
              <View style={styles.stationCard}>
                <View style={styles.stationInfo}>
                  <Text style={styles.stationName}>{item.name}</Text>
                  <Text style={styles.stationDistance}>{distance}km</Text>
                </View>
                <Text style={styles.stationAvailability}>
                  Available: {item.availableSlots}/{item.totalSlots}
                </Text>
                <TouchableOpacity
                  style={styles.detailsButton}
                  onPress={() => navigation.navigate('StationDetails', { stationId: item.id })}
                >
                  <Text style={styles.detailsButtonText}>Chi tiáº¿t</Text>
                </TouchableOpacity>
              </View>
            );
          }}
        />
      </View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1
  },
  map: {
    flex: 1
  },
  stationList: {
    height: 250,
    backgroundColor: '#FFF',
    borderTopLeftRadius: 16,
    borderTopRightRadius: 16,
    padding: 16
  }
  // ... more styles
});
```

2.5.4.3. QRScannerScreen - QuÃ©t mÃ£ QR

Implementation (QRScannerScreen.tsx):
```typescript
import React, { useState, useEffect } from 'react';
import { View, Text, StyleSheet, TouchableOpacity, Alert } from 'react-native';
import { Camera, CameraView } from 'expo-camera';
import { useAuth } from '../contexts';

export default function QRScannerScreen({ navigation, route }: any) {
  const { token } = useAuth();
  const [hasPermission, setHasPermission] = useState<boolean | null>(null);
  const [scanned, setScanned] = useState(false);

  useEffect(() => {
    (async () => {
      const { status } = await Camera.requestCameraPermissionsAsync();
      setHasPermission(status === 'granted');
    })();
  }, []);

  const handleBarCodeScanned = async ({ type, data }: any) => {
    setScanned(true);
    
    try {
      // Parse QR data: format "STATION_ID:1"
      const stationId = parseInt(data.split(':')[1]);

      // Call API to start swap
      const response = await fetch('https://your-backend.herokuapp.com/api/transactions/start-swap', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ stationId })
      });

      const result = await response.json();

      if (result.success) {
        Alert.alert(
          'ThÃ nh cÃ´ng',
          result.message,
          [
            {
              text: 'OK',
              onPress: () => {
                navigation.navigate('Home');
                // TODO: Navigate to transaction confirmation screen
              }
            }
          ]
        );
      } else {
        Alert.alert('Lá»—i', result.message);
        setScanned(false);
      }
    } catch (error) {
      Alert.alert('Lá»—i', 'KhÃ´ng thá»ƒ káº¿t ná»‘i vá»›i server');
      setScanned(false);
    }
  };

  if (hasPermission === null) {
    return <Text>Äang yÃªu cáº§u quyá»n camera...</Text>;
  }
  if (hasPermission === false) {
    return <Text>KhÃ´ng cÃ³ quyá»n truy cáº­p camera</Text>;
  }

  return (
    <View style={styles.container}>
      <CameraView
        style={styles.camera}
        onBarcodeScanned={scanned ? undefined : handleBarCodeScanned}
        barcodeScannerSettings={{
          barcodeTypes: ['qr']
        }}
      >
        <View style={styles.overlay}>
          <View style={styles.scanArea} />
          <Text style={styles.instructionText}>
            ÄÆ°a mÃ£ QR vÃ o khung Ä‘á»ƒ quÃ©t
          </Text>
        </View>
      </CameraView>

      {scanned && (
        <TouchableOpacity
          style={styles.rescanButton}
          onPress={() => setScanned(false)}
        >
          <Text style={styles.rescanText}>QuÃ©t láº¡i</Text>
        </TouchableOpacity>
      )}
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1
  },
  camera: {
    flex: 1
  },
  overlay: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: 'rgba(0,0,0,0.5)'
  },
  scanArea: {
    width: 250,
    height: 250,
    borderWidth: 2,
    borderColor: '#FFF',
    backgroundColor: 'transparent'
  },
  instructionText: {
    color: '#FFF',
    marginTop: 24,
    fontSize: 16
  }
  // ... more styles
});
```

2.5.4.4. WalletScreen - VÃ­ tiá»n

Implementation snippet:
```typescript
export default function WalletScreen({ navigation }: any) {
  const { user, token, updateUser } = useAuth();
  const [transactions, setTransactions] = useState([]);

  const handleRecharge = async (amount: number) => {
    try {
      const response = await fetch('https://your-backend.herokuapp.com/api/payment/momo/create', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ amount })
      });

      const data = await response.json();

      if (data.success) {
        // Open MoMo payment URL
        Linking.openURL(data.payUrl);
      }
    } catch (error) {
      Alert.alert('Lá»—i', 'KhÃ´ng thá»ƒ táº¡o Ä‘Æ¡n náº¡p tiá»n');
    }
  };

  return (
    <View style={styles.container}>
      <View style={styles.balanceCard}>
        <Text style={styles.balanceLabel}>Sá»‘ dÆ° hiá»‡n táº¡i</Text>
        <Text style={styles.balanceAmount}>{user?.balance.toLocaleString()}Ä‘</Text>
        
        <View style={styles.rechargeOptions}>
          <TouchableOpacity onPress={() => handleRecharge(50000)}>
            <Text>50,000Ä‘</Text>
          </TouchableOpacity>
          <TouchableOpacity onPress={() => handleRecharge(100000)}>
            <Text>100,000Ä‘</Text>
          </TouchableOpacity>
          <TouchableOpacity onPress={() => handleRecharge(200000)}>
            <Text>200,000Ä‘</Text>
          </TouchableOpacity>
        </View>
      </View>

      <Text style={styles.sectionTitle}>Lá»‹ch sá»­ giao dá»‹ch</Text>
      <FlatList
        data={transactions}
        keyExtractor={(item) => item.id.toString()}
        renderItem={({ item }) => (
          <WalletTransactionItem transaction={item} />
        )}
      />
    </View>
  );
}
```

2.5.5. API INTEGRATION

2.5.5.1. API Client Setup

File: services/api.ts

```typescript
import axios from 'axios';
import AsyncStorage from '@react-native-async-storage/async-storage';

const API_BASE_URL = 'https://your-backend.herokuapp.com/api';

const apiClient = axios.create({
  baseURL: API_BASE_URL,
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
});

// Request interceptor - Add token
apiClient.interceptors.request.use(
  async (config) => {
    const token = await AsyncStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// Response interceptor - Handle errors
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      // Token expired, logout
      AsyncStorage.removeItem('token');
      AsyncStorage.removeItem('user');
      // Navigate to login screen
    }
    return Promise.reject(error);
  }
);

export default apiClient;
```

2.5.5.2. Custom Hooks for Data Fetching

File: hooks/useStations.ts

```typescript
import { useState, useEffect } from 'react';
import apiClient from '../services/api';

export function useStations(status?: string) {
  const [stations, setStations] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    fetchStations();
  }, [status]);

  const fetchStations = async () => {
    try {
      setLoading(true);
      const params = status ? { status } : {};
      const response = await apiClient.get('/stations', { params });
      setStations(response.data.stations);
    } catch (err) {
      setError(err);
    } finally {
      setLoading(false);
    }
  };

  return { stations, loading, error, refetch: fetchStations };
}
```

================================================================================
Káº¾T LUáº¬N PHáº¦N 2.5

Thiáº¿t káº¿ á»©ng dá»¥ng di Ä‘á»™ng cá»§a há»‡ thá»‘ng EV-Swap Ä‘áº£m báº£o:
1. User experience mÆ°á»£t mÃ  vá»›i navigation rÃµ rÃ ng
2. Component-based architecture dá»… báº£o trÃ¬ vÃ  má»Ÿ rá»™ng
3. State management hiá»‡u quáº£ vá»›i Context API
4. Real-time data vá»›i hooks vÃ  API integration
5. Responsive UI phÃ¹ há»£p vá»›i nhiá»u kÃ­ch thÆ°á»›c mÃ n hÃ¬nh
6. Multi-language vÃ  theme switching
7. Offline-first approach vá»›i AsyncStorage

á»¨ng dá»¥ng mobile lÃ  cáº§u ná»‘i giá»¯a ngÆ°á»i dÃ¹ng vÃ  há»‡ thá»‘ng backend, mang láº¡i tráº£i 
nghiá»‡m Ä‘á»•i pin nhanh chÃ³ng, tiá»‡n lá»£i vÃ  an toÃ n.
================================================================================
